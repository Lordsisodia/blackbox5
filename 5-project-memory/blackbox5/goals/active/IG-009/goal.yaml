# Goal: Improve Hook Automation
# =============================================================================
goal_id: IG-009
name: "Improve Hook Automation"
description: "Continuously improve the hook system that automates task lifecycle, maintains system state, and makes agents smarter without manual intervention"

meta:
  created: "2026-02-04"
  updated: "2026-02-10"
  target_completion: "ongoing"
  owner: "architect-agent"
  priority: critical
  status: in_progress
  category: infrastructure
  note: "Phase 1 complete (9 hooks). Now continuous improvement including world-class features from IG-010."

# =============================================================================
# SUB-GOALS
# =============================================================================

sub_goals:
  - id: SG-009-1
    name: "Phase 1: Core Hook Infrastructure"
    description: "Build foundational hooks (COMPLETED: 9 hooks deployed)"
    weight: 20
    status: completed

    acceptance_criteria:
      - "SessionStart hooks auto-detect agent type"
      - "PreToolUse security hooks active"
      - "Subagent tracking functional"
      - "All hooks registered in settings.json"

  - id: SG-009-2
    name: "Phase 2: Task Lifecycle Automation"
    description: "Automate task status transitions, claiming, and completion"
    weight: 20
    status: not_started

    acceptance_criteria:
      - "Auto-claim task from queue on session start"
      - "Auto-update status to in_progress"
      - "Pre-completion validation hooks"
      - "Auto-mark complete when criteria met"

  - id: SG-009-3
    name: "Phase 3: Quality and Safety Hooks"
    description: "Enforce quality gates and safety checks automatically"
    weight: 20
    status: not_started

    acceptance_criteria:
      - "Git safety guards (no force push to main)"
      - "Quality gate validation before commits"
      - "Context warnings at 70% usage"
      - "Pre-commit validation suite"

  - id: SG-009-4
    name: "Phase 4: Intelligence Hooks"
    description: "Hooks that make agents smarter - memory search, decision extraction"
    weight: 20
    status: not_started

    acceptance_criteria:
      - "Smart memory search on context gaps"
      - "Auto-extract decisions to DECISIONS.md"
      - "Verification subagent triggers"
      - "Pattern detection and suggestion"

  - id: SG-009-5
    name: "Phase 5: Best Practice Integration"
    description: "Integrate patterns from 19+ GitHub hook repositories"
    weight: 20
    status: not_started

    acceptance_criteria:
      - "multi-agent-ralph-loop patterns integrated"
      - "juno-code lifecycle hooks adapted"
      - "SWE-agent patterns where applicable"
      - "BB5-specific innovations documented"

# =============================================================================
# PROGRESS
# =============================================================================

progress:
  percentage: 20
  last_updated: "2026-02-10"

  by_sub_goal:
    SG-009-1: 100  # Phase 1 complete
    SG-009-2: 0   # Phase 2 not started
    SG-009-3: 0   # Phase 3 not started
    SG-009-4: 0   # Phase 4 not started
    SG-009-5: 0   # Phase 5 not started

  summary:
    total_tasks: 7
    completed_tasks: 7
    in_progress_tasks: 0
    blocked_tasks: 0
    note: "Phase 1 (9 hooks) complete. Phases 2-5 represent continuous improvement."

# =============================================================================
# LINKS
# =============================================================================

links:
  decisions:
    - DEC-2026-02-04-hook-framework

  learnings:
    - "GitHub: carlrannaberg/claudekit - Quality enforcement hooks"
    - "GitHub: hesreallyhim/awesome-claude-code - Community hooks"
    - "GitHub: affaan-m/everything-claude-code - Memory persistence hooks"

  related_goals:
    - IG-006  # Architecture restructuring (hooks support this)
    - CG-003  # System Integrity (hooks enforce this)
    - CG-004  # Navigation (hooks enhance this)

  plans:
    - hook-system-infrastructure

  tasks:
    - TASK-HOOK-001  # Create settings.json
    - TASK-HOOK-002  # Auto-claim tasks

# =============================================================================
# NOTES
# =============================================================================

notes: |
  MERGED IG-010 on 2026-02-10: World-class hook system is now part of
  continuous improvement. The "world-class" features become Phase 5.

  SMART HOOKS PRINCIPLE: No environment variables needed
  =====================================================
  All hooks self-discover context from:
  - Run directory path (runs/planner/, runs/executor/)
  - Current working directory
  - File patterns (queue.yaml = planner, task-*-spec.md = executor)
  - Parent directory structure

  This makes hooks work automatically regardless of how agents are spawned.

  Hook Inventory (9 total deployed, more in development):
  ========================================================

  SessionStart Hooks:
  - session-start-blackbox5.sh - Agent-aware context loading
  - bb5-discover-context - Auto-context detection

  PreToolUse Hooks:
  - pre-tool-security.py - Agent-aware security
  - pre-tool-validation.sh - Structure validation

  PostToolUse Hooks:
  - timeline-maintenance.sh - Auto-update timeline

  Subagent Hooks:
  - subagent-tracking.sh - Agent lifecycle logging

  Stop Hooks:
  - stop-hierarchy-update.sh - Parent timeline updates

  Phases 2-5 Roadmap:
  - Phase 2: Task lifecycle automation (auto-claim, auto-complete)
  - Phase 3: Quality gates and safety enforcement
  - Phase 4: Intelligence hooks (memory, decisions, verification)
  - Phase 5: Best practices from 19+ GitHub repos integrated
