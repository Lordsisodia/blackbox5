# BlackBox5 Run Archive Policy
# Defines retention rules and archival procedures for run folders

policy:
  name: "BlackBox5 Run Archival Policy"
  version: "1.0.0"
  created: "2026-02-07"
  description: "Automated archival and cleanup policy for run folders"

# Retention Rules
retention:
  # Keep last N runs per agent type (never archive these)
  keep_last_runs: 50

  # Archive runs older than X days
  archive_after_days: 30

  # Delete archived runs after X days
  delete_after_days: 365

  # Special tags that prevent archival
  preserve_tags:
    - milestone
    - important
    - reference
    - audit
    - compliance

  # Active task runs are never archived
  preserve_active_tasks: true

# Compression Settings
compression:
  format: "tar.gz"
  level: 6
  preserve_permissions: true
  preserve_timestamps: true

# Archive Organization
archive:
  # Archive location relative to .autonomous/
  archive_dir: "archive/runs"

  # Naming convention: archive-YYYY-MM.tar.gz
  naming_pattern: "archive-{year}-{month}.tar.gz"

  # Create monthly archives
  grouping: "monthly"

  # Maximum archive size before splitting (in MB)
  max_archive_size_mb: 500

# Archive Index
index:
  # Index file location
  index_file: "archive/runs-index.json"

  # Fields to index for searchability
  indexed_fields:
    - run_id
    - agent_type
    - task_id
    - start_time
    - end_time
    - tags
    - status
    - archive_location

# Cleanup Schedule
schedule:
  # Run archival check weekly
  frequency: "weekly"

  # Day of week (0=Sunday, 1=Monday, etc.)
  day: 0

  # Time to run (24-hour format)
  time: "02:00"

  # Or use cron expression
  cron: "0 2 * * 0"

# Notifications
notifications:
  # Log archival actions
  log_actions: true

  # Log file location
  log_file: "archive/archival.log"

  # Summary report after each run
  generate_report: true

# Restore Settings
restore:
  # Temporary extraction directory
  temp_dir: "archive/temp"

  # Preserve original archive after restore
  preserve_archive: true

# Exclusions
exclusions:
  # Patterns to exclude from archival
  patterns:
    - "*.tmp"
    - "*.log"
    - ".DS_Store"
    - "__pycache__"
    - "node_modules"

  # Specific directories to exclude
  directories:
    - ".git"
    - ".venv"
    - "venv"
