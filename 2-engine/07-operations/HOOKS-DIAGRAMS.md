# Claude Code Hooks System: Visual Architecture

**Component**: Blackbox5 Engine (07-operations)
**Version**: 1.0.0
**Date**: 2026-01-21

---

## System Context

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BLACKBOX5 SYSTEM                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  01-core: Agents, Orchestration, Routing                       â”‚ â”‚
â”‚  â”‚  - TaskRouter, Orchestrator, AgentMemory                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â†‘                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  07-operations: Runtime, Workflows, Monitoring                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  HOOKS SYSTEM                                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Event Interception                                â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - UserPromptSubmit â†’ 5 hooks                     â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - PreToolUse â†’ 4 hooks                           â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - PostToolUse â†’ 6 hooks                          â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - SessionStart â†’ 2 hooks                         â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - SessionEnd â†’ 2 hooks                           â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - SubagentStop â†’ 1 hook                          â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Automated Validation                              â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - Context boundaries, Impact analysis             â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - Completion criteria, Reversibility              â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Memory Persistence                                â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - Activity logging, Decision capture              â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  - Pattern detection, Knowledge extraction         â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  05-project-memory: Decisions, Knowledge, Sessions               â”‚ â”‚
â”‚  â”‚  - decisions/, knowledge/, operations/, sessions/                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Hook Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude Code     â”‚
â”‚ Event Triggers  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: Event Matching (.claude/settings.json)                â”‚
â”‚                                                                 â”‚
â”‚  Event: "PostToolUse:Write"                                     â”‚
â”‚  â”œâ”€ Matcher: "Edit|Write" âœ“                                     â”‚
â”‚  â”œâ”€ Hooks found: 6                                              â”‚
â”‚  â””â”€ Selected: auto-log, capture-decisions, debt detection,      â”‚
â”‚                stakeholders, test-coverage, subagent-quality   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: Parallel Execution                                    â”‚
â”‚                                                                 â”‚
â”‚  â”œâ”€ hook1.sh (PID: 1234, timeout: 5s)                          â”‚
â”‚  â”œâ”€ hook2.sh (PID: 1235, timeout: 5s)                          â”‚
â”‚  â”œâ”€ hook3.sh (PID: 1236, timeout: 10s)                         â”‚
â”‚  â”œâ”€ hook4.sh (PID: 1237, timeout: 5s)                          â”‚
â”‚  â”œâ”€ hook5.sh (PID: 1238, timeout: 10s)                         â”‚
â”‚  â””â”€ hook6.sh (PID: 1239, timeout: 10s)                         â”‚
â”‚                                                                 â”‚
â”‚  All hooks execute simultaneously                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: Synchronization                                      â”‚
â”‚                                                                 â”‚
â”‚  Waiting for all hooks to complete...                          â”‚
â”‚  â”œâ”€ hook1.sh âœ“ exit 0 (45ms)                                   â”‚
â”‚  â”œâ”€ hook2.sh âœ“ exit 0 (12ms)                                   â”‚
â”‚  â”œâ”€ hook3.sh âœ“ exit 0 (2.3s)                                   â”‚
â”‚  â”œâ”€ hook4.sh âœ“ exit 0 (8ms)                                    â”‚
â”‚  â”œâ”€ hook5.sh âœ“ exit 0 (1.8s)                                   â”‚
â”‚  â””â”€ hook6.sh âœ“ exit 0 (450ms)                                  â”‚
â”‚                                                                 â”‚
â”‚  Max duration: 2.3s                                            â”‚
â”‚  All hooks exited with code 0 â†’ CONTINUE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Action Continuesâ”‚
â”‚ (Tool executes) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Event Hook Mapping

```
                    CLAUDE CODE EVENTS
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚  START   â”‚        â”‚  MIDDLE  â”‚        â”‚   END   â”‚
    â”‚          â”‚        â”‚          â”‚        â”‚         â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚                   â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚                        â”‚                        â”‚
    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚              â”‚  UserPromptSubmit  â”‚             â”‚
    â”‚              â”‚  - First principlesâ”‚             â”‚
    â”‚              â”‚  - Assumptions     â”‚             â”‚
    â”‚              â”‚  - Task complexity â”‚             â”‚
    â”‚              â”‚  - Dependencies    â”‚             â”‚
    â”‚              â”‚  - Knowledge gaps  â”‚             â”‚
    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                        â”‚                        â”‚
    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚              â”‚  SessionStart      â”‚             â”‚
    â”‚              â”‚  - Environment     â”‚             â”‚
    â”‚              â”‚  - Time tracking   â”‚             â”‚
    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                        â”‚                        â”‚
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚         â”‚  PreToolUse                  â”‚        â”‚
    â”‚         â”‚  - Context boundary          â”‚        â”‚
    â”‚         â”‚  - Impact analysis           â”‚        â”‚
    â”‚         â”‚  - Reversibility             â”‚        â”‚
    â”‚         â”‚  - Completion validation     â”‚        â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                        â”‚                        â”‚
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚         â”‚  PostToolUse                 â”‚        â”‚
    â”‚         â”‚  - Auto-log                  â”‚        â”‚
    â”‚         â”‚  - Decisions                 â”‚        â”‚
    â”‚         â”‚  - Technical debt            â”‚        â”‚
    â”‚         â”‚  - Stakeholders              â”‚        â”‚
    â”‚         â”‚  - Test coverage             â”‚        â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                        â”‚                        â”‚
    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚              â”‚  SubagentStop      â”‚             â”‚
    â”‚              â”‚  - Quality check   â”‚             â”‚
    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                        â”‚                        â”‚
    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚              â”‚  SessionEnd        â”‚             â”‚
    â”‚              â”‚  - Memory extract  â”‚             â”‚
    â”‚              â”‚  - Pattern detect  â”‚             â”‚
    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                        â”‚                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Memory Persistence

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SESSION FLOW                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Request
    â”‚
    â”œâ”€â†’ [First Principles Hook]
    â”‚   â””â”€â†’ Inject thinking framework
    â”‚
    â”œâ”€â†’ [Assumption Detection Hook]
    â”‚   â””â”€â†’ Question implicit assumptions
    â”‚
    â”œâ”€â†’ Claude Processes & Executes
    â”‚
    â”œâ”€â†’ [PreToolUse Hooks]
    â”‚   â”œâ”€â†’ Check context boundary
    â”‚   â”œâ”€â†’ Analyze change impact
    â”‚   â”œâ”€â†’ Check reversibility
    â”‚   â””â”€â†’ Validate completion
    â”‚
    â”œâ”€â†’ Tool Executes (Edit/Write/etc)
    â”‚
    â”œâ”€â†’ [PostToolUse Hooks]
    â”‚   â”œâ”€â†’ Auto-log to WORK-LOG.md
    â”‚   â”œâ”€â†’ Capture decision (if applicable)
    â”‚   â”œâ”€â†’ Detect technical debt
    â”‚   â”œâ”€â†’ Detect stakeholders
    â”‚   â””â”€â†’ Validate test coverage
    â”‚
    â””â”€â†’ Result Presented

[Session Ends]
    â”‚
    â””â”€â†’ [SessionEnd Hooks]
        â”œâ”€â†’ Extract memories
        â”‚   â”œâ”€â†’ decisions/ (decision records)
        â”‚   â”œâ”€â†’ knowledge/ (learnings & insights)
        â”‚   â””â”€â†’ operations/ (patterns, debt, quality)
        â””â”€â†’ Detect patterns
            â””â”€â†’ Frequently edited files
```

---

## Git Hooks Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GIT WORKFLOW                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

$ git add files
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ pre-commit Hook   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Check .env filesâ”‚
â”‚ âœ“ Warn large filesâ”‚
â”‚ âœ“ Run tests (opt) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Pass
         â†“
$ git commit -m "message"
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ commit-msg Hook   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Format check    â”‚
â”‚ âœ“ Block generic   â”‚
â”‚ âœ“ Require body    â”‚
â”‚   (if large)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Pass
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Commit Accepted   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example Valid Commits:
  âœ“ feat(auth): add JWT support
  âœ“ fix(api): resolve timeout issue
  âœ“ docs(readme): update installation

Example Blocked Commits:
  âœ— wip
  âœ— fix
  âœ— updates
  âœ— tmp
```

---

## File Structure Map

```
blackbox5/
â”‚
â”œâ”€â”€ .claude/                              # Claude Code Configuration
â”‚   â”œâ”€â”€ settings.json                    # Hook definitions
â”‚   â”œâ”€â”€ CLAUDE.md                        # Project context
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                           # Hook Scripts (18 files)
â”‚   â”‚   â”œâ”€â”€ ğŸ”¹ Critical Hooks (9)
â”‚   â”‚   â”‚   â”œâ”€â”€ auto-log-activity.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ extract-memories.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ first-principles-trigger.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ capture-decisions.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ check-context-boundary.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ analyze-change-impact.sh
â”‚   â”‚   â”‚   â”œâ”€â”€ validate-completion.sh
â”‚   â”‚   â”‚   â””â”€â”€ check-reversibility.sh
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ”¸ High-Value Hooks (9)
â”‚   â”‚       â”œâ”€â”€ detect-assumptions.sh
â”‚   â”‚       â”œâ”€â”€ check-task-complexity.sh
â”‚   â”‚       â”œâ”€â”€ detect-dependencies.sh
â”‚   â”‚       â”œâ”€â”€ detect-knowledge-gaps.sh
â”‚   â”‚       â”œâ”€â”€ detect-technical-debt.sh
â”‚   â”‚       â”œâ”€â”€ detect-stakeholders.sh
â”‚   â”‚       â”œâ”€â”€ validate-test-coverage.sh
â”‚   â”‚       â”œâ”€â”€ validate-environment.sh
â”‚   â”‚       â”œâ”€â”€ manage-session-time.sh
â”‚   â”‚       â”œâ”€â”€ detect-patterns.sh
â”‚   â”‚       â””â”€â”€ analyze-subagent-quality.sh
â”‚   â”‚
â”‚   â”œâ”€â”€ README.md                        # Hook documentation
â”‚   â”œâ”€â”€ verify-hooks.sh                  # Verification script
â”‚   â”œâ”€â”€ check-status.sh                  # Status checker
â”‚   â””â”€â”€ install-git-hooks.sh             # Git hooks installer
â”‚
â”œâ”€â”€ .git/hooks/                          # Git Hooks (2 files)
â”‚   â”œâ”€â”€ commit-msg                       # Commit message validation
â”‚   â””â”€â”€ pre-commit                       # Pre-commit validation
â”‚
â””â”€â”€ 5-project-memory/siso-internal/      # Memory Storage
    â”œâ”€â”€ decisions/                       # Auto-populated by hooks
    â”œâ”€â”€ knowledge/                       # Auto-populated by hooks
    â”œâ”€â”€ operations/                      # Auto-populated by hooks
    â”‚   â”œâ”€â”€ agent-quality.txt            # Subagent quality log
    â”‚   â”œâ”€â”€ pattern-detection.txt        # Pattern tracking
    â”‚   â””â”€â”€ technical-debt.txt           # Debt tracking
    â”œâ”€â”€ sessions/                        # Session records
    â”œâ”€â”€ WORK-LOG.md                      # Auto-generated activity log
    â””â”€â”€ STATE.yaml                       # Single source of truth
```

---

## First Principles: Problem â†’ Solution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROBLEMS IDENTIFIED                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. âŒ AI operates without persistent context                   â”‚
â”‚  2. âŒ AI repeats mistakes across sessions                      â”‚
â”‚  3. âŒ AI makes shallow decisions                               â”‚
â”‚  4. âŒ AI doesn't understand impact of changes                  â”‚
â”‚  5. âŒ AI can waste spend on bad work                          â”‚
â”‚  6. âŒ Git history becomes messy                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ First Principles Analysis
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FUNDAMENTAL SOLUTIONS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Problem 1 â†’ âœ… Auto-log everything (WORK-LOG.md)               â”‚
â”‚  Problem 2 â†’ âœ… Extract memories (decisions/, knowledge/)        â”‚
â”‚  Problem 3 â†’ âœ… First principles triggering                      â”‚
â”‚  Problem 4 â†’ âœ… Impact analysis before edits                     â”‚
â”‚  Problem 5 â†’ âœ… Quality gates (completion, test coverage)        â”‚
â”‚  Problem 6 â†’ âœ… Atomic commit enforcement (git hooks)            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Implementation: 18 Hooks
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RESULTS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  âœ… Complete audit trail (every action tracked)                 â”‚
â”‚  âœ… Organizational memory (learnings persist)                   â”‚
â”‚  âœ… Better thinking (first principles auto-triggered)           â”‚
â”‚  âœ… Safer changes (impact analysis, reversibility)              â”‚
â”‚  âœ… Higher quality (completion validation, test coverage)       â”‚
â”‚  âœ… Clean git history (conventional commits enforced)            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Performance Characteristics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EXECUTION PROFILE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Parallel Execution:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Event: PostToolUse:Write (6 hooks)                     â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ Timeline:                                              â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook1.sh starts                             â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook2.sh starts                             â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook3.sh starts                             â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook4.sh starts                             â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook5.sh starts                             â”‚   â”‚
â”‚  â”‚ 0ms    â”Œâ”€ hook6.sh starts                             â”‚   â”‚
â”‚  â”‚ 12ms   â””â”€ hook2.sh completes (12ms)                   â”‚   â”‚
â”‚  â”‚ 45ms   â””â”€ hook1.sh completes (45ms)                   â”‚   â”‚
â”‚  â”‚ 450ms  â””â”€ hook6.sh completes (450ms)                  â”‚   â”‚
â”‚  â”‚ 1800ms â””â”€ hook5.sh completes (1.8s)                   â”‚   â”‚
â”‚  â”‚ 2300ms â””â”€ hook3.sh completes (2.3s) â† MAX             â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ Total: 2.3s (limited by slowest hook)                 â”‚   â”‚
â”‚  â”‚ Serial would be: ~4.6s                                â”‚   â”‚
â”‚  â”‚ Parallel savings: ~50%                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Cost Optimization:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Bash hooks (type: "command")                            â”‚   â”‚
â”‚  â”‚ - Fast: ~50-200ms average                               â”‚   â”‚
â”‚  â”‚ - Cost: $0 (local execution)                            â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ Prompt hooks (type: "prompt")                           â”‚   â”‚
â”‚  â”‚ - Slower: ~2-5s average                                 â”‚   â”‚
â”‚  â”‚ - Cost: API credits (Haiku call)                       â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ Recommendation: Use bash hooks by default               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Related Documentation

| Document | Purpose |
|----------|---------|
| [`HOOKS-ARCHITECTURE.md`](./HOOKS-ARCHITECTURE.md) | Complete system documentation |
| [`HOOKS-QUICK-REFERENCE.md`](./HOOKS-QUICK-REFERENCE.md) | Quick reference guide |
| [`README.md`](./README.md) | Operations layer overview |
| [`.claude/hooks/README.md`](../../.claude/hooks/README.md) | Hook-specific documentation |
